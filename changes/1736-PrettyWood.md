Fix behaviour with forward refs and optional fields in nested models